{% extends "dialog.html" %}

{% block title %}{{ 'Profile download'|t }}{% endblock %}

{% block content %}
<main>
<h1>geteduroam<small>â€“ eduroam authentication made easy</small></h1>
<form method="POST" action="{{ action }}" id="form-download">
{% if realms|length == 1 %}
<p>{{ 'Download starting'|t }}</p>
<details>
	<summary>{{ 'Download not starting?'|t }}</summary>
{% else %}
{% include 'realm-picker.html' %}
{% endif %}
	<p><input type="hidden" name="format" value="{{ format }}"><button type="submit" class="btn btn-default" id="btn-download">{{ 'Start download'|t }}</button></p>
</form>
{% if realms|length == 1 %}
</details>
{% endif %}
<hr>

{% if passphrase %}
<p>{{ 'Use passphrase when prompted:'|t }}</p>
<p id="passphrase-show">{{ passphrase }}</p>
<hr>
{% endif %}

{% if format == 'apple-mobileconfig' %}
<p>{{ 'apple-mobileconfig instructions'|t }}</p>
<p aria-hidden="true">
	<picture class="screenshot mac">
	<source srcset="{{ _basePath }}/assets/mac/sonoma-dark.png" media="(prefers-color-scheme: dark)">
	<img src="{{ _basePath }}/assets/mac/sonoma.png">
</picture>
</p>
{% endif %}

{% if format == 'google-onc' %}
<p>{{ 'google-onc instructions'|t }}</p>
{% endif %}

</main>

{% if realms|length != 1 %}
{# We use a CSP with script-src: none, so this won't work:
<script>
	document.getElementById('form-download').submit();
	document.getElementById('btn-download').remove();
</script>
#}
{% endif %}
{% endblock %}
